<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>2025 封關工具</title>
  <script src="2025.js"></script>
  <style>
    body { background:#000; color:#fff; font-family:monospace; padding:20px; }
    .box { border:2px solid #444; padding:15px; background:#111; }
    /* 紅框：輸入區 */
    textarea { width:100%; height:100px; background:#222; color:#fff; border:1px solid #f00; margin-bottom:10px; padding:10px; }
    button { width:100%; padding:15px; background:#f00; color:#fff; font-weight:bold; border:none; cursor:pointer; }
    /* 藍字：結果區 */
    pre { color:#3498db; background:#000; padding:15px; border:1px dashed #444; margin-top:20px; }
    .count { color:#ff0; font-size:12px; margin-bottom:5px; }
  </style>
</head>
<body>
<div class="box">
  <div class="count" id="info">讀取中...</div>
  <textarea id="input" placeholder="貼入網頁文字..."></textarea>
  <button onclick="run()">執行並清空</button>
  <pre id="output"></pre>
</div>

<script>
let seen = new Set();
// 初始化讀取現有資料
if (typeof ywnData !== 'undefined') {
  ywnData.forEach(d => seen.add(d[0]));
  document.getElementById('info').innerText = `目前已有：${seen.size} 筆`;
}

function run() {
  const el = document.getElementById('input');
  const txt = el.value;
  const dates = txt.match(/2025\/\d{2}\/\d{2}/g);
  const segs = txt.split(/2025\/\d{2}\/\d{2}/);
  let res = [];

  if (dates) {
    dates.forEach((d, i) => {
      if (!seen.has(d)) {
        const n = (segs[i+1] || segs[i]).match(/\d{2}/g);
        if (n && n.length >= 5) {
          const w = ["(日)","(一)","(二)","(三)","(四)","(五)","(六)"][new Date(d).getDay()];
          res.push(`["${d}","${w}",["${n.slice(0,5).join('","')}"]]`);
        }
      }
    });
    document.getElementById('output').innerText = res.length > 0 ? res.join(",\n") + "," : "無新資料";
    el.value = ""; // 該刪的都刪了 (清空輸入框)
  }
}
</script>
</body>
</html>
